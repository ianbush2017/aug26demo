import pygame, math, random

# --- Setup ---
pygame.init()
WIDTH, HEIGHT = 640, 480
screen = pygame.display.set_mode((WIDTH, HEIGHT))
clock = pygame.time.Clock()

# Colors
WHITE = (255, 255, 255)
RED   = (200, 0, 0)
BLACK = (0, 0, 0)
GREEN = (0, 200, 0)

# Player
player_health = 100
max_health = 100
flash_alpha = 0  # red flash transparency

# Enemy (demo: press SPACE to simulate being hit)
enemy_damage = 20

# --- Draw Health Bar ---
def draw_health_bar(surface, x, y, w, h, health, max_health):
    ratio = health / max_health
    pygame.draw.rect(surface, RED,   (x, y, w, h))                # background (lost HP)
    pygame.draw.rect(surface, GREEN, (x, y, w * ratio, h))        # current HP
    pygame.draw.rect(surface, WHITE, (x, y, w, h), 2)             # border

# --- Main Loop ---
running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
    
    keys = pygame.key.get_pressed()
    if keys[pygame.K_SPACE]:  # simulate damage
        if player_health > 0:
            player_health -= enemy_damage
            player_health = max(0, player_health)
            flash_alpha = 150   # trigger red flash

    # --- Update flash ---
    if flash_alpha > 0:
        flash_alpha -= 5  # fade speed
    
    # --- Drawing ---
    screen.fill((50, 50, 50))  # background
    
    # Draw player health bar (bottom center)
    bar_width, bar_height = 200, 20
    draw_health_bar(screen, WIDTH//2 - bar_width//2, HEIGHT - 40,
                    bar_width, bar_height, player_health, max_health)

    # Draw red flash overlay
    if flash_alpha > 0:
        flash_surface = pygame.Surface((WIDTH, HEIGHT))
        flash_surface.set_alpha(flash_alpha)
        flash_surface.fill(RED)
        screen.blit(flash_surface, (0, 0))

    # Info text
    font = pygame.font.SysFont(None, 24)
    txt = font.render("Press SPACE to simulate damage", True, WHITE)
    screen.blit(txt, (20, 20))
    
    pygame.display.flip()
    clock.tick(60)

pygame.quit()
